!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).webInject=t()}(this,function(){"use strict";function r(){return void 0===window}function c(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}function e(){this.finishedTask=[]}return e.prototype.create=function(){return new e},e.prototype.js=function(e,t){if(this.finishedTask.find(function(e){e.url}))t();else{var n,s,i,o=function(){this.finishedTask.push({url:e,type:"js",status:"loaded"}),t()};if(r())if(window.document.querySelector('[src="'+e+'"]'))o();else 0==e.indexOf("http")||0==e.indexOf("/")?(n=e,s=o,(i=document.createElement("script")).setAttribute("type","text/javascript"),i.setAttribute("src",n),i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||setTimeout(function(){s()},100)},c(i)):function(e,t){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.appendChild(document.createTextNode(e)),this.appendToHead(n),this.asyncCallback(t)}(e,o);else o()}},e.prototype.css=function(e,t){if(this.finishedTask.find(function(e){e.url}))t();else{var n,s,i,o=function(){this.finishedTask.push({url:e,type:"css",status:"loaded"}),t()};if(r())if(window.document.querySelector('[href="'+e+'"]'))o();else 0==e.indexOf("http")||0==e.indexOf("/")?(n=e,s=o,(i=document.createElement("link")).onload=i.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||s&&s()},-1==n.lastIndexOf(".css")&&(n+=".css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",n),c(i)):function(e,t){var n=document.createElement("style");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),this.appendToHead(n);var s=n.getAttribute("media");null==s||/screen/.test(s.toLowerCase())||n.setAttribute("media","screen"),n.styleSheet?n.styleSheet.cssText+=e:document.getBoxObjectFor?n.innerHTML+=e:n.appendChild(document.createTextNode(e)),this.asyncCallback(t)}(e,o);else o()}},e.prototype.image=function(e,t){var n,s,i;r()&&(n=e,s=t,(i=document.createElement("img")).src=n,i.complete?s():(i.onload=function(){s()},i.onerror=function(e){s()}))},e.prototype.getTagMap=function(e,t){var n={js:[],css:[]};return this.finishedTask.forEach(function(e){"js"===e.type?n.js.push('<script type="text/javascript" src="'+e.url+'"><\/script>'):"css"===e.type&&n.css.push('<link rel="stylesheet" href="'+e.url+'"></link>')}),n},new e});
